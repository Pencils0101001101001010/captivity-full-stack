generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["fullTextSearch"]
}

datasource db {
  provider  = "postgresql"
  url       = env("POSTGRES_PRISMA_URL")
  directUrl = env("POSTGRES_URL_NON_POOLING")
}

enum UserRole {
  USER
  CUSTOMER
  SUBSCRIBER
  PROMO
  DISTRIBUTOR
  SHOPMANAGER
  EDITOR
  ADMIN
}

model User {
  id           String    @id
  username     String    @unique
  displayName  String
  email        String?   @unique
  passwordHash String?
  googleId     String?   @unique
  avatarUrl    String?
  bio          String?
  role         UserRole  @default(USER)
  sessions     Session[]
  Product      Product[]

  createdAt DateTime @default(now())

  @@map("users")
}

model Session {
  id        String   @id
  userId    String
  expiresAt DateTime
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("sessions")
}

// prisma/schema.prisma

model Product {
  id                Int     @id @default(autoincrement())
  userId            String
  user              User    @relation(fields: [userId], references: [id], onDelete: Cascade)
  type              String
  sku               String
  name              String
  published         Boolean
  isFeatured        Boolean
  visibility        String
  shortDescription  String
  taxStatus         String
  inStock           Boolean
  backordersAllowed Boolean
  soldIndividually  Boolean
  allowReviews      Boolean
  categories        String
  tags              String
  imageUrl          String
  upsells           String?
  position          Int
  attribute1Name    String?
  attribute1Values  String?
  attribute2Name    String?
  attribute2Values  String?
  regularPrice      Float? // For variation types
  stock             Int? // For variation types

  createdAt DateTime @default(now())

  @@map("products")
}
